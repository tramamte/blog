+++
title = "중학교 수학으로 이해하는 디피-헬만 키 교환"
description = "디피-헬만 키 교환의 이해"
topics = ["security"]
tags = ["diffie-hellman", "key", "exchange"]
slug = "diffie-hellman"
date = "2018-07-19T16:15:37+09:00"
imports = ["math", "sequence"]
draft = true
+++

디피-헬만 키 교환(Diffie-Hellman key exchange)은 말 그대로 키를 교환하는 방식을 정의한 것이다. 키는 안전한 전달을 위해 정보를 암호화할 때 필요한데, 디피-헬만 키 교환 방식에 의해 통신 당사자들은 하나의 키를 공유할 수 있으므로 암호화/복호화에 동일한 키를 사용하는 대칭 키 암호화 방식(symmetric key algorithm)을 위한 키 교환에 주로 사용한다.

# 대칭 키 암호화 알고리즘과 키

예를 들어, A가 B에게 "abcd"라는 메시지를 보낼 때 다른 사람은 이 메시지를 볼 수 없도록 암호화한다고 가정해 보자.

가장 간단히 생각해 볼 수 있는 방식으로 각 문자를 알파벳 순서 상 바로 다음 문자로 변경해 보내는 것을 생각해 볼 수 있다. 즉, "bcde"라고 보내는 것이다.

B는 A에게서 "bcde"라는 메시지를 받으면 각 문자를 알파벳 순서 상 바로 전 문자로 변경해 원문을 확인할 수 있다.

이 방식이 가능하려면 A와 B는 다음 정보를 공유하고 있어야 한다.

- 알파벳 상 일정 순서 뒤의 문자로 치환하는 방식으로 암호화했다.
- 일정 순서는 1이다.

이 중 첫 번째에 해당하는 정보가 바로 암호화 알고리즘이며, 두 번째에 해당하는 정보가 암호화 키이다. 예의 암호화 알고리즘은 암호화와 복호화에 동일한 키를 사용하기 때문에 대칭 키 암호화 알고리즘이다.

A와 B가 안전한 통신을 하기 위해서는 이 두 가지 정보를 모두 숨기는 것이 좋다. 하지만 나머지 하나의 정보를 모르면 한 가지 정보만으로는 의미가 없기 때문에 둘 중 하나의 정보만 숨겨도 된다.

이제 하나만 숨기고 나머지 하나를 공개한다면 어떤 것을 숨기는 것이 더 좋을까? 이는 둘 중 어떤 것이 더 경우의 수가 많은지를 생각하면 답이 자명하다. 경우의 수가 많아야 다른 사람이 암호를 풀기 더 어려워지기 때문이다. 암호화 알고리즘 보다는 암호화 키의 경우의 수가 훨씬 다양하므로 대부분의 암호화 통신은 다음과 유사한 절차로 진행된다.

{{< sequence >}}

A->B: Let's communicate using Algorithm #1

B->A: OK

Note over A,B: Start cryptographic communication

A->B: bsahjuaoihj4ertlv89hjipaf

{{< /sequence >}}

# 디피-헬만 키 교환

이제 A와 B가 안전하게 키만 교환할 수 있으면 A, B 간 암호화 통신이 가능하다. 가장 쉽게 생각할 수 있는 방식은 별도의 수단을 이용해 A와 B가 키를 사전에 공유하는 것이다. 문자메시지를 암호화하고 싶다면, 문자메시지와 다른 수단인 이메일이나 종이에 키를 적어 전해주는 것이다. 이렇게 공유한 키를 사전 공유키(PSK, Pre-Shared Key)라 한다.

PSK는 키 교환 절차가 번거롭고, 별도의 수단이 안전하다는 보장성이 약하다는 문제가 있다. 디피-헬만 키 교환은 동일한 수단을 통해서도 간단하고, 안전한 키 교환을 가능하게 한다.

## 키 교환 절차

1. A는 