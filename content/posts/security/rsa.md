+++
title = "중학교 수학으로 이해하는 RSA"
description = "RSA 암호화의 이해"
topics = ["security"]
tags = ["pki", "rsa", "cryptography"]
slug = "rsa"
date = "2018-07-17T16:20:45+09:00"
imports = ["math"]
draft = true
+++

PKI의 근간이 되는 RSA 암호화에 대해 중학교 수준의 수학만을 사용해 알아보자. 이해를 위해 필요한 기반 지식들 역시 최대한 간단히, 중학교 수준에서만 다룬다.

# 기반 지식

RSA를 이해하는데 필요한 오일러 피 함수(Euler's phi function 또는 Euler's totient function), 페르마 소정리(Fermat's little theorem)와 이를 일반화한 오일러 정리(Euler's theorem)에 대해 간략히 알아보자.

## 오일러 피 함수 (Euler's phi function)

오일러 피 함수는 1부터 \\(n\\)까지의 양의 정수 중 \\(n\\)과 서로소[^1]인 것의 개수를 함수 형태로 나타낸 것이다. 일반적으로 \\(\varphi(n)\\)이나 \\(\phi(n)\\)으로 표기한다.

[^1]: 최대공약수가 1인 관계. 즉, 1 이외의 공약수를 갖지 않는 관계

예를 들면,

- 3을 기준으로 1부터 3까지의 양의 정수 1, 2, 3 중 3과 서로소인 수는 1, 2이므로 \\(\varphi(3) = 2\\)
- 4를 기준으로 1부터 4까지의 양의 정수 1, 2, 3, 4 중 4와 서로소인 수는 1, 3이므로 \\(\varphi(4) = 2\\)
- 5를 기준으로 1부터 5까지의 양의 정수 1, 2, 3, 4, 5 중 5와 서로소인 수는 1, 2, 3, 4이므로 \\(\varphi(5) = 4\\)
- 6을 기준으로 1부터 6까지의 양의 정수 1, 2, 3, 4, 5, 6 중 6과 서로소인 수는 1, 5이므로 \\(\varphi(6) = 2\\)
- 7을 기준으로 1부터 7까지의 양의 정수 1, 2, 3, 4, 5, 6, 7 중 7과 서로소인 수는 1, 2, 3, 4, 5, 6이므로 \\(\varphi(7) = 6\\)
- 8을 기준으로 1부터 8까지의 양의 정수 1, 2, 3, 4, 5, 6, 7, 8 중 8과 서로소인 수는 1, 3, 5, 7이므로 \\(\varphi(8) = 4\\)

이 된다.

특징이 보이는가? 보이지 않는다면 소수의 정의를 한 번 생각해 보자. 소수는 1과 자기 자신 외에는 나누어 떨어지지 않는 수이다. 그런데 피 함수는 1은 개수에 포함한다. 따라서 여기서 피 함수의 첫 번째 특징을 알 수 있다.

{{% box "#ffeeff" %}}

\\(n\\)이 소수인 경우,

$$\varphi(n) = (n - 1)$$

{{% /box %}}

6의 경우를 다시 보자. 6을 소인수분해[^2]하면 1, 6 외에도 2, 3의 약수---또는 인수---를 갖는다. 따라서 \\(\varphi(6)\\)은 1부터 6까지 전체 6개의 숫자 중 자기 자신(6) 한 개, 2의 배수(2, 4) 두 개, 3의 배수(3) 한 개를 뺀 \\(6 - (1 + 2 + 1) = 2\\)가 된다.

[^2]: 합성수를 소수의 곱으로 나타내는 방법

이를 기반으로 사고를 확장해 보면, \\(m\\)과 \\(n\\)이 서로 다른 소수인 경우---당연히 서로소가 된다--- \\(m\\)과 \\(n\\)을 곱한 수 \\(mn\\)의 피 함수 값 \\(\varphi(mn)\\)은 전체 \\(mn\\)개의 숫자 중 \\(1m\\), \\(2m\\), ..., \\(nm\\) 등 \\(m\\)의 배수 \\(n\\)개를 제외하고, \\(1n\\), \\(2n\\), ..., \\(mn\\) 등 \\(n\\)의 개수 \\(m\\)개를 제외한 뒤 자기 자신(\\(mn\\))은 두 번 제외됐으므로 한 번 더해주는 방식으로 구할 수 있다. 여기서 두 번째 특징이 나온다.

{{% box "#ffeeff" %}}

\\(m\\), \\(n\\)이 서로 다른 소수인 경우 두 수의 곱에 대한 피 함수 값 \\(\varphi(mn)\\)은 다음과 같이 구할 수 있다.

$$ \varphi(mn) = mn - n - m + 1 = (m - 1)(n - 1) $$

따라서 아래 등식이 성립한다.

$$ \varphi(mn) = \varphi(m)\varphi(n) $$

{{% /box %}}

## 페르마 소정리 (Fermat's littel theorem)



## 오일러 정리 (Euler's theorem)



# 키 생성 절차

# 암호화 및 복호화 예제 